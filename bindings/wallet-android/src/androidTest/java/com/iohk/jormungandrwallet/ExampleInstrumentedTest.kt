package com.iohk.jormungandrwallet

import androidx.test.ext.junit.runners.AndroidJUnit4

import org.junit.Test
import org.junit.runner.RunWith

import org.junit.Assert.*

/**
 * Instrumented test, which will execute on an Android device.
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
@RunWith(AndroidJUnit4::class)
class ExampleInstrumentedTest {


    private fun hexStringToByteArray(s: String): ByteArray {
        val len = s.length
        val data = ByteArray(len / 2)
        var i = 0
        while (i < len) {
            data[i / 2] = ((Character.digit(s[i], 16) shl 4)
                    + Character.digit(s[i + 1], 16)).toByte()
            i += 2
        }
        return data
    }

    @Test
    fun yoroi_wallet_value() {
        val mnemonics : String = "neck bulb teach illegal soul cry monitor claw amount boring provide village rival draft stone"
        val block0: ByteArray = hexStringToByteArray(
                "00520000000002bd000000000000000000000000a3337aad1e5b7a5e087f670aa010ba2a672d8e24d287163bb2b110493b4bd0e1000000000000000000000000000000000000000000000000000000000000000000a60000000e0088000000005e922c7000410100c200010398000000000000000a000000000000000200000000000000640104000000b401411404040000a8c00208000000000000006402440001900001840000006405810104c800005af3107a40000521020000000000000064000000000000000d0000000000000013000000010000000302e0e57ceb3b2832f07e2ef051e772b62a837f7a486c35e38f51bf556bd3abcd8eca011900010400000000000f4240004c82d818584283581c6d98461e5aef17ab5496bf783b71da2b656eb7c6790faa0d673f34c3a101581e581c09d916be1b66db97fb515b3e904ae3433b3258f1687b0daa5b0c8cfe001ad9702d710000000000002710002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c70000000000000001004c82d818584283581c6d98461e5aef17ab5496bf783b71da2b656eb7c6790faa0d673f34c3a101581e581c09d916be1b66db97fb515b3e904ae3433b3258f1687b0daa5b0c8cfe001ad9702d710000000000000064002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c700f800010400000000000f4240002b82d818582183581c783fd3008d0d8fb4532885481360cb6e97dc7801c8843f300ed69a56a0001a7d83a21d0000000000002710002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c70000000000000001002b82d818582183581c783fd3008d0d8fb4532885481360cb6e97dc7801c8843f300ed69a56a0001a7d83a21d0000000000000064004c82d818584283581ced04a9707aa5ff1788c700e4b0433f7a0d619afdaad303c16fba9766a101581e581c09d916be1b67db97fb515a3e1cb846e5ba15c8756dc05e75e66deda3001a2202011a"
        )
        val WALLET_VALUE: Int = 1000000 + 10000 + 10000 + 1 + 100
        val wallet = Wallet(mnemonics)
        val funds = wallet.initialFunds(this.block0)
        val value = wallet.value()
        assertEquals(value, WALLET_VALUE)
    }

    @Test
    fun daedalus_wallet_value() {
        val mnemonics : String = "tired owner misery large dream glad upset welcome shuffle eagle pulp time"
        val block0: ByteArray = hexStringToByteArray(
                "00520000000002bd000000000000000000000000a3337aad1e5b7a5e087f670aa010ba2a672d8e24d287163bb2b110493b4bd0e1000000000000000000000000000000000000000000000000000000000000000000a60000000e0088000000005e922c7000410100c200010398000000000000000a000000000000000200000000000000640104000000b401411404040000a8c00208000000000000006402440001900001840000006405810104c800005af3107a40000521020000000000000064000000000000000d0000000000000013000000010000000302e0e57ceb3b2832f07e2ef051e772b62a837f7a486c35e38f51bf556bd3abcd8eca011900010400000000000f4240004c82d818584283581c6d98461e5aef17ab5496bf783b71da2b656eb7c6790faa0d673f34c3a101581e581c09d916be1b66db97fb515b3e904ae3433b3258f1687b0daa5b0c8cfe001ad9702d710000000000002710002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c70000000000000001004c82d818584283581c6d98461e5aef17ab5496bf783b71da2b656eb7c6790faa0d673f34c3a101581e581c09d916be1b66db97fb515b3e904ae3433b3258f1687b0daa5b0c8cfe001ad9702d710000000000000064002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c700f800010400000000000f4240002b82d818582183581c783fd3008d0d8fb4532885481360cb6e97dc7801c8843f300ed69a56a0001a7d83a21d0000000000002710002b82d818582183581cadff678b11b127aef0c296e88bfb4769c905284716c23e5d63278787a0001a63f679c70000000000000001002b82d818582183581c783fd3008d0d8fb4532885481360cb6e97dc7801c8843f300ed69a56a0001a7d83a21d0000000000000064004c82d818584283581ced04a9707aa5ff1788c700e4b0433f7a0d619afdaad303c16fba9766a101581e581c09d916be1b67db97fb515a3e1cb846e5ba15c8756dc05e75e66deda3001a2202011a"
        )
        val WALLET_VALUE: Int = 100000 + 1010
        val wallet = Wallet(mnemonics)
        val funds = wallet.initialFunds(this.block0)
        val value = wallet.value()
        assertEquals(value, WALLET_VALUE)
    }
}
